set $_CONFIG_DIR  $HOME/dotfiles/sway
set $_BG_DIR $HOME/SafeDepositBox/backgrounds/public
set $_LOGOUT swaynag -t warning -m 'Exit i3?' -b 'Exit i3' 'swaymsg exit'
set $_LOCK exec swaylock -f -c 000000
set $_REBOOT swaynag -t warning -m 'Reboot?' -b 'Reboot' 'systemctl reboot'
set $_SHUTDOWN swaynag -t warning -m 'Power off?' -b 'Power off' 'systemctl poweroff -i'
set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown

# Appearance ##################################################################
for_window [class="^.*"] border pixel 1
gaps inner 2
font monospace 0
titlebar_border_thickness 1
titlebar_padding 1

## Background
output * bg "$($HOME/dotfiles/bin/random-wallpaper $_BG_DIR)" fill

## Colors (see http://i3wm.org/docs/userguide.html#_changing_colors)
set $fore   #e2e2e2
set $fade   #e2e2e295
set $back   #1b1b1b
set $bact   #1b1b1b95
set $trns   #00000000
set $acto   #852000
set $actt   #85200095
set $hint   #9a0027

### Class               Border  Background  Text    Indicator   Child Border
client.unfocused        $back   $bact       $fade   $bact       $back
client.focused_inactive $actt   $actt       $fade   $actt       $actt
client.focused          $acto   $acto       $fore   $acto       $acto
client.urgent           $hint   $hint       $back   $hint       $hint
client.placeholder      $back   $bact       $fade   $bact       $back
client.background       $bact

# Startup Actions #############################################################

# Finalize host-specific configuration of status bar
exec $_CONFIG_DIR/bar-config $_CONFIG_DIR

# Start a bunch of stuff
# exec --no-startup-id bitwarden-bin
exec signal-desktop

# Power management
exec --no-startup-id swayidle -w timeout 300 "$_LOCK"


# Make an information bar
bar {
    colors {
        # Item              Border  Background  Text
        background                  $trns
        focused_workspace   $acto   $acto       $fore
        active_workspace    $back   $acto       $fore
        inactive_workspace  $back   $back       $fade
        urgent_workspace    $hint   $hint       $back
    }
	font pango:Source Code Pro, Font Awesome 5 Free Solid 12
    position top
    status_command i3status-rs $_CONFIG_DIR/status.toml
}

# Bindings ####################################################################
# use Mouse+Mod1 to drag floating windows to their wanted position
floating_modifier Mod1

# start a terminal
bindsym Mod1+Return exec $HOME/dotfiles/bin/start-gui-term
bindsym Menu exec $HOME/dotfiles/bin/start-gui-term
bindsym Super_R exec $HOME/dotfiles/bin/start-gui-term

# kill focused window
bindsym Mod1+c kill

# start rofi (a program launcher)
bindsym Super_L exec rofi -show combi
bindsym Mod1+Tab exec rofi -show combi

# change focus
bindsym Mod1+Left focus left
bindsym Mod1+s focus left
bindsym Mod1+h focus left
bindsym Mod1+Down focus down
bindsym Mod1+d focus down
bindsym Mod1+j focus down
bindsym Mod1+Up focus up
bindsym Mod1+e focus up
bindsym Mod1+k focus up
bindsym Mod1+Right focus right
bindsym Mod1+f focus right
bindsym Mod1+l focus right

# move focused window
bindsym Mod1+Shift+Left move left
bindsym Mod1+Shift+s move left
bindsym Mod1+Shift+h move left
bindsym Mod1+Shift+Down move down
bindsym Mod1+Shift+d move down
bindsym Mod1+Shift+j move down
bindsym Mod1+Shift+Up move up
bindsym Mod1+Shift+e move up
bindsym Mod1+Shift+k move up
bindsym Mod1+Shift+Right move right
bindsym Mod1+Shift+f move right
bindsym Mod1+Shift+l move right

# split in horizontal orientation
bindsym Mod1+b h

# split in vertical orientation
bindsym Mod1+v split v

# enter fullscreen mode for the focused container
bindsym Mod1+F11 fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
# bindsym Mod1+q layout stacking
bindsym Mod1+u layout tabbed
bindsym Mod1+y layout toggle split

# toggle tiling / floating
bindsym Mod1+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym Mod1+space focus mode_toggle

# focus the parent container
bindsym Mod1+t focus parent

# focus the child container
bindsym Mod1+g focus child

# move the currently focused window to the scratchpad
bindsym Mod1+Shift+minus move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym Mod1+minus scratchpad show

# switch to workspace
bindsym Mod1+1 workspace 1
bindsym Mod1+2 workspace 2
bindsym Mod1+3 workspace 3
bindsym Mod1+4 workspace 4
bindsym Mod1+5 workspace 5
bindsym Mod1+6 workspace 6
bindsym Mod1+7 workspace 7
bindsym Mod1+8 workspace 8
bindsym Mod1+9 workspace 9
bindsym Mod1+0 workspace 10

# move focused container to workspace
bindsym Mod1+Shift+1 move container to workspace 1
bindsym Mod1+Shift+2 move container to workspace 2
bindsym Mod1+Shift+3 move container to workspace 3
bindsym Mod1+Shift+4 move container to workspace 4
bindsym Mod1+Shift+5 move container to workspace 5
bindsym Mod1+Shift+6 move container to workspace 6
bindsym Mod1+Shift+7 move container to workspace 7
bindsym Mod1+Shift+8 move container to workspace 8
bindsym Mod1+Shift+9 move container to workspace 9
bindsym Mod1+Shift+0 move container to workspace 10

# move back and forth
workspace_auto_back_and_forth yes
bindsym Mod1+z workspace back_and_forth
bindsym Mod1+Shift+z move container to workspace back_and_forth; workspace back_and_forth

# move to urgent window
bindsym Mod1+x [urgent=latest] focus

# reload the configuration file
bindsym Mod1+Shift+r reload

# restart
# bindsym Mod1+Shift+r restart

# exit i3 (logs you out of your X session)
bindsym Mod1+Shift+q exec --no-startup-id $_LOGOUT

# shutdown, reboot, lock menu from https://wiki.archlinux.org/index.php/I3
mode "$mode_system" {
    bindsym l exec --no-startup-id $_LOCK, mode "default"
    bindsym e exec --no-startup-id $_LOGOUT, mode "default"
    bindsym s exec --no-startup-id $_LOCK && systemctl suspend, mode "default"
    bindsym h exec --no-startup-id $_LOCK && systemctl hibernate, mode "default"
    bindsym r exec --no-startup-id $_REBOOT, mode "default"
    bindsym Shift+s exec --no-startup-id $_SHUTDOWN, mode "default"
    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym Control+Mod1+Delete mode "$mode_system"

# lock screen with ALT+L
bindsym Mod2+l $_LOCK

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode
        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym Left        resize shrink width 10 px or 1 ppt
        bindsym Down        resize grow height 100 px or 1 ppt
        bindsym Up          resize shrink height 10 px or 1 ppt
        bindsym Right       resize grow width 100 px or 1 ppt
        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym Mod1+r mode "resize"

# PulseAudio controls
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5%
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle

# Touchpad controls
bindsym XF86TouchpadToggle exec $HOME/dotfiles/bin/toggletouchpad # toggle touchpad

# Media player controls
bindsym XF86AudioPlay exec playerctl play
bindsym XF86AudioPause exec playerctl pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

# Screenshots
bindsym Print exec sleep 3 && grim $HOME/Pictures/Screenshots/`uname -n`-`date +%Y%m%d-%R:%S`.png
bindsym Mod1+Print exec grim -g "$(slurp)" $HOME/Pictures/Screenshots/`uname -n`-`date +%Y%m%d-%R:%S`.png
